# Rule-Extraction
This repository contains code for rule extraction from a Neural Network using TREPAN. This is an initial README file that contains the basics. The scripts are also commented as much as possible.

Not all of the scripts are to be used for the task. Following are some of the scipts that are important:

1. data_preprocessing.py: This script creates the training and test files from the GSP data, required to run the NN classifier.
2. encoder.py: This script converrts the categorical features in the data to numeric data, using numeric (ordinal) encoding.
3. run_gsp.py: This script takes as input the GSP data for underwriter (a csv file), and generates the rules using TREPAN. However, the rules contain feature indices and not feature names. The indices need to be converted to feature names later. It also creates and saves the model (NN based) which is used for the classification.
4. trepan.py: This is the main TREPAN script, and its methods are called by run_gsp.py. It uses the basic TREPAN algorithm as described in with some modifications. For example, in actual TREPAN, an m-of-n split is suggested, but the script uses a binary C4.5 split to make the decision trees. Also, the tree growth is restricted to only one condition, which is the number of nodes must not exceed MAX_NODES. The code saves all rules generated in a file.
5. print_unique_rules.py: This script takes input of the file generated by trepan.py, and extracts unique, raw rules in a file. By raw rules, we mean rules where the right hand side of a rule is an encoded value (e.g. gender>=0.5). Such rules need to be converted to their proper form (e.g. gender=='MALE').
6.  rule_coverage_file2_NN_based.py: This script calculates the coverage of each rule, and also converts the raw rules (obtained in step 5) to their proper form. We also select the top n rules with highest coverage in this script.
7.  originalise_rules3.py: This script takes the top n rules file from step 6, and converts the categorical values to actual sets. For example, a rule like city>=4.5 is converted to city not in ['Delhi','Mumbai','Kolkata', ...].
